-- scott 연습문제

--01
SELECT EMPNO, ENAME, SAL
FROM emp
WHERE deptno = 10;

--02
SELECT ename, hiredate, deptno
FROM emp
WHERE EMPNO = 7369;

--03
SELECT *
FROM emp
WHERE ENAME = 'ALLEN';

--04
SELECT ENAME,DEPTNO,SAL
FROM EMP
WHERE HIREDATE = '81/02/20';

--05
SELECT*
FROM EMP
WHERE job != 'MANAGER';

--06
SELECT *
FROM EMP
WHERE hiredate >= '81/04/02';

--07
SELECT ename, sal, deptno
FROM EMP
WHERE SAL >= 800;

--08
SELECT *
FROM EMP
WHERE deptno >= 20;

--09
SELECT *
FROM EMP
WHERE ENAME > 'K';

--10
SELECT *
FROM EMP
WHERE HIREDATE < '81-12-09';

--11
SELECT EMPNO, ENAME
FROM EMP
WHERE EMPNO <= 7698;

--12
SELECT ENAME,SAL,DEPTNO
FROM EMP
WHERE HIREDATE BETWEEN '81-04-02'AND'82-12-09';

--13
SELECT ENAME, JOB, SAL
FROM EMP
WHERE SAL >1600
AND SAL <3000;

--14
SELECT *
FROM EMP
WHERE EMPNO NOT BETWEEN 7654 AND 7782;

--15
SELECT*
FROM EMP
WHERE ENAME BETWEEN 'B' AND 'J';

--16===================================================
SELECT *
FROM EMP
WHERE TRUNC(HIREDATE, 'YYYY') != '81-01-01';

--17
SELECT *
FROM EMP
WHERE JOB IN('MANAGER','SALESMAN');

--18
SELECT ENAME, EMPNO, DEPTNO
FROM EMP
WHERE DEPTNO NOT IN(20,30);

--19
SELECT EMPNO, ENAME, HIREDATE, DEPTNO
FROM EMP
WHERE ENAME LIKE 'S%';

--20=================================================
SELECT *
FROM EMP
WHERE TRUNC(HIREDATE,'YYYY') = '81-01-01';

--21
SELECT*
FROM EMP
WHERE ENAME LIKE '%S%';

--22
SELECT*
FROM EMP
WHERE ENAME LIKE 'M____N';

--23
SELECT*
FROM EMP
WHERE ENAME LIKE '_A%';

--24
SELECT*
FROM EMP
WHERE COMM IS NULL;

--25
SELECT*
FROM EMP
WHERE COMM IS NOT NULL;

--26
SELECT ENAME, DEPTNO, SAL
FROM EMP
WHERE DEPTNO = 30
AND SAL >= 1500;

-- 27
SELECT EMPNO, ENAME,DEPTNO
FROM EMP
WHERE ENAME LIKE 'K%'
OR DEPTNO = 30;

--28
SELECT *
FROM EMP
WHERE SAL >=1500
AND DEPTNO = 30
AND JOB = 'MANAGER';

--29
SELECT *
FROM EMP
WHERE DEPTNO = 30
ORDER BY DEPTNO;

--30
SELECT *
FROM EMP
ORDER BY SAL DESC;

--31
SELECT *
FROM EMP
ORDER BY DEPTNO, SAL DESC;

--32
SELECT DEPTNO, ENAME, SAL
FROM EMP
ORDER BY DEPTNO DESC, ENAME ASC, SAL DESC;

--33
SELECT ENAME, SAL, ROUND(SAL*13/100) AS BONUS, DEPTNO
FROM EMP
WHERE DEPTNO = 10;

--34
SELECT ENAME, SAL, NVL(COMM,0), SAL+NVL(COMM,0) AS TOTAL
FROM EMP
ORDER BY TOTAL DESC;

--35 ===============================
SELECT ENAME, SAL, TO_CHAR(ROUND(SAL*15/100,1),'$999.9') AS 회비
FROM EMP
WHERE SAL BETWEEN 1500 AND 3000;

--36 =================GROUP BY 할때 SELECT 랑 같이 묶기=========================
SELECT DNAME, COUNT(E.EMPNO)
FROM DEPT D
    JOIN EMP E
    ON D.DEPTNO = E.DEPTNO
GROUP BY DNAME
HAVING COUNT(*) >5;


--37
SELECT JOB, SUM(SAL) AS 급여합계
FROM EMP
WHERE JOB !='SALESMAN'
GROUP BY JOB
HAVING SUM(SAL) > 5000;

--38
SELECT EMPNO, ENAME, SAL, GRADE
FROM EMP
    JOIN SALGRADE S
    ON SAL BETWEEN S.LOSAL AND S.HISAL;

--39
SELECT DEPTNO, COUNT(*) AS 사원수, COUNT(COMM) AS "커미션 받은 사원수"
FROM EMP
GROUP BY DEPTNO;

--40
SELECT ENAME, DEPTNO,
    CASE
        WHEN DEPTNO = 10 THEN '총무부'
        WHEN DEPTNO = 20 THEN '개발부'
        WHEN DEPTNO = 30 THEN '영업부'
    END AS 부서명
FROM EMP;




--EX1
SELECT EMPNO, ENAME, SAL
FROM EMP
WHERE DEPTNO = 10;

--EX2
SELECT ENAME,HIREDATE,DEPTNO
FROM EMP
WHERE EMPNO =7369;

--EX3
SELECT *
FROM EMP
WHERE ENAME = 'ALLEN';

--EX4
SELECT ENAME,DEPTNO,SAL
FROM EMP
WHERE HIREDATE = '1981.02.20';

--EX5
SELECT *
FROM EMP
WHERE JOB != 'MANAGER';

--EX6
SELECT*
FROM EMP
WHERE HIREDATE >= '81.04.02';

--EX7
SELECT ENAME,SAL,DEPTNO
FROM EMP
WHERE SAL >= 800;

--EX8
SELECT*
FROM EMP
WHERE DEPTNO >= 20;

--EX9
SELECT*
FROM EMP
WHERE ENAME > 'KZZZZZ';

--EX10
SELECT*
FROM EMP
WHERE HIREDATE < '81.12.09';


--EX11
SELECT EMPNO, ENAME
FROM EMP
WHERE EMPNO <=7698;

--EX12
SELECT ENAME,SAL,DEPTNO
FROM EMP
WHERE HIREDATE BETWEEN '81.04.02' AND '82.12.09';

--EX13
SELECT ENAME, JOB, SAL
FROM EMP
WHERE SAL >1600
AND SAL <3000;

--EX14
SELECT *
FROM EMP
WHERE EMPNO NOT BETWEEN 7654 AND 7782;

--EX15
SELECT *
FROM EMP
WHERE ENAME BETWEEN 'B' AND 'J';

--EX16
SELECT *
FROM EMP
WHERE TRUNC(HIREDATE,'YYYY') != '81.01.01';

--EX17
SELECT*
FROM EMP
WHERE JOB IN('MANAGER','SALESMAN');

--EX18
SELECT ENAME, EMPNO, DEPTNO
FROM EMP
WHERE DEPTNO NOT IN(20,30);

--EX19
SELECT EMPNO, ENAME, HIREDATE, DEPTNO
FROM EMP
WHERE ENAME LIKE 'S%';

--EX20
SELECT *
FROM EMP
WHERE TRUNC(HIREDATE,'YYYY') = '81.01.01';

--EX21
SELECT *
FROM EMP
WHERE ENAME LIKE '%S%';

--EX22
SELECT *
FROM EMP
WHERE ENAME LIKE 'M____N';

--EX23
SELECT*
FROM EMP
WHERE ENAME LIKE '_A%';

--EX24
SELECT *
FROM EMP
WHERE COMM IS NULL;

--EX25
SELECT *
FROM EMP
WHERE COMM IS NOT NULL;

--EX26
SELECT ENAME, DEPTNO, SAL
FROM EMP
WHERE DEPTNO = 30
AND SAL >=1500;

--EX27
SELECT EMPNO, ENAME, DEPTNO
FROM EMP
WHERE ENAME LIKE 'K%'
OR DEPTNO = 30;

--EX28
SELECT *
FROM EMP
WHERE SAL >= 1500
AND DEPTNO = 30
AND JOB = 'MANAGER';

--EX29
SELECT *
FROM EMP
WHERE DEPTNO = 30
ORDER BY EMPNO;

--EX30
SELECT *
FROM EMP
ORDER BY SAL DESC;

--EX31
SELECT *
FROM EMP
ORDER BY DEPTNO ASC,SAL DESC;

--EX32
SELECT DEPTNO, ENAME, SAL
FROM EMP
ORDER BY DEPTNO DESC, ENAME ASC, SAL DESC;

--EX33
SELECT ENAME, SAL, ROUND(SAL*13/100) AS BONUS, DEPTNO
FROM EMP
WHERE DEPTNO = 10;

--EX34
SELECT ENAME, SAL, NVL(COMM,0) , SAL+NVL(COMM,0) AS TOTAL
FROM EMP
ORDER BY TOTAL DESC;

--EX35
SELECT ENAME, SAL, TO_CHAR(ROUND(SAL*15/100,1),'$999.9') AS 회비
FROM EMP
WHERE SAL BETWEEN 1500 AND 3000;

--EX36
SELECT DNAME, COUNT(*)
FROM EMP E
    JOIN DEPT D
    ON E.DEPTNO = D.DEPTNO
GROUP BY DNAME
HAVING COUNT(*) >5;

--EX37
SELECT JOB, SUM(SAL) AS 급여합계
FROM EMP
WHERE JOB != 'SALESMAN'
GROUP BY JOB
HAVING SUM(SAL) >5000;

--EX38
SELECT EMPNO, ENAME, SAL, GRADE
FROM EMP E
    JOIN SALGRADE S
    ON E.SAL BETWEEN S.LOSAL AND S.HISAL;

--EX39
SELECT DEPTNO, COUNT(*) AS 사원수, COUNT(COMM)
FROM EMP
GROUP BY DEPTNO;

--EX40
SELECT ENAME,DEPTNO,
    DECODE(DEPTNO,
        10,'총무부',
        20,'개발부',
        30,'영업부') AS 부서명
FROM EMP;


SELECT ENAME,DEPTNO,
    CASE
        WHEN DEPTNO = 10 THEN '총무부'
        WHEN DEPTNO = 20 THEN '개발부'
        WHEN DEPTNO = 30 THEN '영업부'
    END AS 부서명
FROM EMP;





